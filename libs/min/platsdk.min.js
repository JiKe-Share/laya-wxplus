var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();var cafesdk;(function(cafesdk){cafesdk.netswh=[];function netswh_init($swh){for(var i=0;i<$swh.length;i++){cafesdk.netswh[i]=Number($swh[i])}cafe.event.dispatch("NETSWH_LOAD_END")}cafesdk.netswh_init=netswh_init;function getnetswh(index){return cafesdk.netswh&&cafesdk.netswh[index]==1}cafesdk.getnetswh=getnetswh})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){cafesdk.ad={};cafesdk.adstate={};function ad_init($ad,callback){cafesdk.ad.admap={};for(var s in $ad){var key=$ad[s][3];if(key==0){cafesdk.ad[s]={};cafesdk.ad[s]["type"]=$ad[s][0];cafesdk.ad[s]["swh"]=$ad[s][1];cafesdk.ad[s]["aid"]=$ad[s][2];cafesdk.ad[s]["pos"]=$ad[s][3];cafesdk.ad[s]["trigger"]=$ad[s][4]}else{cafesdk.ad.admap[key]={};cafesdk.ad.admap[key]["type"]=$ad[s][0];cafesdk.ad.admap[key]["swh"]=$ad[s][1];cafesdk.ad.admap[key]["aid"]=$ad[s][2];cafesdk.ad.admap[key]["pos"]=$ad[s][3];cafesdk.ad.admap[key]["trigger"]=$ad[s][4]}}cafesdk.log("admap:",cafesdk.ad.admap);cafesdk.ad.isAdHander=callback}cafesdk.ad_init=ad_init;function getad(pos){cafesdk.log("admappos"+pos+": "+JSON.stringify(cafesdk.ad.admap));return cafesdk.ad.admap&&cafesdk.ad.admap[pos]}cafesdk.getad=getad;function getadbytype(type){for(var s in cafesdk.ad.admap){var o=cafesdk.ad.admap[s];if(o.type==type){return o}}return null}cafesdk.getadbytype=getadbytype;function getadsbytype(type){var list=[];for(var s in cafesdk.ad.admap){var o=cafesdk.ad.admap[s];if(o.type==type){list[list.length]=o}}return list}cafesdk.getadsbytype=getadsbytype;function setAdState(type,state){cafesdk.adstate[type]=state}cafesdk.setAdState=setAdState;function getAdState(type){return cafesdk.adstate[type]}cafesdk.getAdState=getAdState})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){cafesdk.RESOURCE_VERSION=0;cafesdk.RESOURCE_PATH="";cafesdk.RESOURCE_URL="";cafesdk.CONFIG_VERSION=0;cafesdk.CONFIG_PATH="";cafesdk.config={};var currData;function config_init($conifg){for(var s in $conifg){cafesdk.config[s]=$conifg[s]}cafesdk.RESOURCE_VERSION=$conifg["RESOURCE_VERSION"];cafesdk.RESOURCE_PATH=$conifg["RESOURCE_PATH"];if(cafesdk.RESOURCE_PATH==""){cafesdk.RESOURCE_URL=""}else{if(cafesdk.RESOURCE_VERSION!=0){cafesdk.RESOURCE_URL=cafesdk.RESOURCE_PATH+cafesdk.RESOURCE_VERSION+"/"}else{cafesdk.RESOURCE_URL=cafesdk.RESOURCE_PATH}}cafesdk.CONFIG_PATH=$conifg["CONFIG_PATH"];cafesdk.CONFIG_VERSION=$conifg["CONFIG_VERSION"];currData=Laya.LocalStorage.getJSON(cafesdk.config.GAMEID+"_CURRDATA");if(!currData)currData={time:new Date().valueOf()}}cafesdk.config_init=config_init;function getCurrDayData($name){var currtime=new Date().getDate();var datatime=new Date(currData.time).getDate();if(currtime!=datatime){currData={time:new Date().valueOf()}}if(!currData[$name]){currData[$name]=0}return currData[$name]}cafesdk.getCurrDayData=getCurrDayData;function setCurrDayData($name,$value){var currtime=new Date().getDate();var datatime=new Date(currData.time).getDate();if(currtime!=datatime){currData={time:new Date().valueOf()}}currData[$name]=$value}cafesdk.setCurrDayData=setCurrDayData})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){cafesdk.share={};function share_init($shareTemp,callback){cafesdk.share.shareTemp=$shareTemp;cafesdk.share.isShareHandler=callback}cafesdk.share_init=share_init})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){cafesdk.swh={};function swh_init($swh){for(var s in $swh){cafesdk.swh[s]=$swh[s]}}cafesdk.swh_init=swh_init})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){cafesdk.toGameSWH={};function togame_init($games,$togame){cafesdk.games=$games;cafesdk.togame=$togame}cafesdk.togame_init=togame_init;function getTogameByName(keyname){var list=[];var arr=cafesdk.togame[keyname];if(arr){for(var i=0;i<arr.length;i++){var game=cafesdk.games[arr[i]];if(game){list[list.length]=game}}}return list}cafesdk.getTogameByName=getTogameByName})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){function log(message){var optionalParams=[];for(var _i=1;_i<arguments.length;_i++){optionalParams[_i-1]=arguments[_i]}if(cafesdk.swh.log){console.log(message,optionalParams)}}cafesdk.log=log;function error(message){var optionalParams=[];for(var _i=1;_i<arguments.length;_i++){optionalParams[_i-1]=arguments[_i]}if(cafesdk.swh.log){console.error(message,optionalParams)}}cafesdk.error=error;function info(message){var optionalParams=[];for(var _i=1;_i<arguments.length;_i++){optionalParams[_i-1]=arguments[_i]}if(cafesdk.swh.log){console.info(message,optionalParams)}}cafesdk.info=info;function debug(message){var optionalParams=[];for(var _i=1;_i<arguments.length;_i++){optionalParams[_i-1]=arguments[_i]}if(cafesdk.swh.log){console.debug(message,optionalParams)}}cafesdk.debug=debug})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var utils;(function(utils){function genUUID(){var s=[];var hexDigits="0123456789abcdef";for(var i=0;i<36;i++){s[i]=hexDigits.substr(Math.floor(Math.random()*0x10),1)}s[14]="4";s[19]=hexDigits.substr((s[19]&0x3)|0x8,1);s[8]=s[13]=s[18]=s[23]="-";var uuid=s.join("");return uuid}utils.genUUID=genUUID;function getUUID(){var _uuid=this.localGetItem("_uuid");if(_uuid){slog("uuid:"+_uuid);return _uuid}else{_uuid=this.genUUID();this.localSetItem("_uuid",_uuid)}return _uuid}utils.getUUID=getUUID})(utils=cafesdk.utils||(cafesdk.utils={}))})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var NetCommonSDK=(function(){function NetCommonSDK(){this.name=["北京","天津","河北","山西","内蒙古","辽宁","吉林","黑龙江","上海","江苏","浙江","安徽","福建","江西","山东","河南","湖北","湖南","广东","广西","海南","四川","贵州","云南","西藏","陕西","甘肃","青海","宁夏","新疆","重庆"];this.nameCode=["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"];this.ipAdressUrl=["https://quzhi.zywxgames.com/admin/api/getIpCity",];this.sfcity=""}NetCommonSDK.prototype.dealTakeNum=function(){console.log('---dealTakeNum----');var self=this;var url='https://quzhi.zywxgames.com/admin/api/role?pkm='+cafesdk.config.PACKAGE+'&canshu='+cafesdk.config.CHANNEL+'&iccid='+this.sfip+'&ip='+this.sfip+'&url=new&yys=yd';console.log(url);var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){console.log("canshu value : ",xhr.readyState,xhr.status);if(xhr.readyState==4&&(xhr.status>=200&&xhr.status<400)){var response=xhr.responseText;console.log("response: ",response);self.getGGType=response;cafesdk.netswh_init(response)}};xhr.open("GET",url,true);xhr.send()};NetCommonSDK.prototype.getIpAddressChagne=function(str){var ss="00";for(var i=0;i<this.name.length;i++){if(str.indexOf(this.name[i])!=-1){ss=this.nameCode[i];break}}return ss};NetCommonSDK.prototype.getIpAddress=function(){var self=this;var url=this.ipAdressUrl[0];var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){console.log("canshu ip : ",xhr.readyState,xhr.status);if(xhr.readyState==4&&(xhr.status>=200&&xhr.status<400)){var response=xhr.responseText;self.sfcity=response;console.log('---ip--start pb--'+response);self.sfip=self.getIpAddressChagne(response);self.dealTakeNum()}};xhr.open("GET",url,true);xhr.send()};return NetCommonSDK}());cafesdk.NetCommonSDK=NetCommonSDK})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var net;(function(net){var NetWork=(function(){function NetWork(){}NetWork.getInstance=function(){if(!this._instance){this._instance=new NetWork()}return this._instance};NetWork.sendLog=function(act,msg){var _this=this;return new cafe.com.too(function(succ,fail){var _http=new Laya.HttpRequest();function err(e){}function success(res){try{var data=JSON.parse(res);if(data.ref==0){succ(data.msg)}else{fail(data)}}catch(e){cafesdk.log(NetWork.URL_HTTPGAME+"出错了")}}_http.once(Laya.Event.COMPLETE,_this,success);_http.once(Laya.Event.ERROR,_this,err);var action={};action.act=act;action.tb=NetWork.LOG_GAME_ID;action.data=msg;var url=NetWork.URL_HTTPGAME;url+="?"+JSON.stringify(action);_http.send(url,"","get","text")})};NetWork.URL_HTTPGAME="https://www.dbug.ltd/tt/";NetWork.LOG_GAME_ID="10001";return NetWork}());net.NetWork=NetWork})(net=cafesdk.net||(cafesdk.net={}))})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var GameActionType=(function(){function GameActionType(){}GameActionType.SET_LOADING_PROGRESS=1;GameActionType.LOADING_COMPLETE=2;GameActionType.LOGIN=10001;GameActionType.GET_CONFIG=10002;GameActionType.GET_USER_INFO=10003;GameActionType.GAME_READY=20000;GameActionType.GAME_START=20001;GameActionType.GAME_END=20002;return GameActionType}());cafesdk.GameActionType=GameActionType})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var GetInfoType=(function(){function GetInfoType(){}GetInfoType.openId=1;GetInfoType.isConnected=2;return GetInfoType}());cafesdk.GetInfoType=GetInfoType})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var SDKActionType=(function(){function SDKActionType(){}SDKActionType.SHOW_BANNER=20001;SDKActionType.SHOW_INTER=20002;SDKActionType.SHOW_VIDEO=20003;SDKActionType.SHOW_FULLSCREEN=20004;SDKActionType.HIDE_BANNER=20005;SDKActionType.HIDE_INTER=20006;SDKActionType.HIDE_VIDEO=20007;SDKActionType.HIDE_FULLSCREEN=20008;SDKActionType.SHOW_NATIVE_BANNER=30101;SDKActionType.SHOW_NATIVE_BANNER_CLICK=30202;SDKActionType.SHOW_NATIVE_INTER=30201;SDKActionType.SHOW_NATIVE_INTER_CLICK=30202;SDKActionType.SHOW_NATIVE_VIDEO=30301;SDKActionType.SHOW_NATIVE_VIDEO_CLICK=30302;SDKActionType.HIDE_NATIVE_VIDEO=30303;SDKActionType.SHOW_NATIVE_THREEICON=30401;SDKActionType.SHOW_NATIVE_THREEICON_CLICK=30402;SDKActionType.HIDE_NATIVE_THREEICON=30403;SDKActionType.DISPOSE_NATIVE_THREEICON=30404;SDKActionType.SHOW_NATIVE_ICON=30501;SDKActionType.SHOW_NATIVE_ICON_CLICK=30502;SDKActionType.HIDE_NATIVE_ICON=30503;SDKActionType.DISPOSE_NATIVE_ICON=30504;SDKActionType.SHARE=40001;SDKActionType.SET_NET_WORK_HANDLER=10001;SDKActionType.START_RECORD_SCREEN=10002;SDKActionType.STOP_RECORD_SCREEN=10003;SDKActionType.GET_RECORD_STATE=10004;SDKActionType.SHOW_GAME_CLUB=10101;SDKActionType.HIDE_GAME_CLUB=10102;SDKActionType.JUMP_GAME=10201;SDKActionType.SHOW_MORE_GAMES=10202;SDKActionType.VIBBRATE_SHORT=10005;SDKActionType.KEEP_SCREEN_ON=10006;SDKActionType.GAME_REPORT=90000;SDKActionType.ADD_TO_MY_APP=10301;SDKActionType.IS_ADD_TO_MY_DESKTOP=10401;SDKActionType.ADD_TO_MY_DESKTOP=10402;return SDKActionType}());cafesdk.SDKActionType=SDKActionType})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var BaseApi=(function(){function BaseApi(){}BaseApi.prototype.init=function(params,callback){};BaseApi.prototype.plat_action=function(act,params,callback){return null};BaseApi.prototype.game_action=function(act,params,callback){return null};BaseApi.prototype.get_info=function(type){return null};return BaseApi}());cafesdk.BaseApi=BaseApi})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var PlatApi=(function(_super){__extends(PlatApi,_super);function PlatApi(){return _super!==null&&_super.apply(this,arguments)||this}Object.defineProperty(PlatApi,"inst",{get:function(){if(!PlatApi._inst)PlatApi._inst=new PlatApi();return PlatApi._inst},enumerable:true,configurable:true});PlatApi.prototype.init=function(params,callback){var self=this;var version=new Date().valueOf()/1000;Laya.loader.load("localSDK.json?v="+version,Laya.Handler.create(self,function(data){var msg;if(typeof data=="string"){msg=JSON.parse(data)}else{msg=data}cafesdk.config_init(msg);Laya.loader.load(cafesdk.CONFIG_PATH+cafesdk.CONFIG_VERSION+".json?v="+version,Laya.Handler.create(self,function(config){if(typeof config=="string"){msg=JSON.parse(config)}else{msg=config}cafesdk.swh_init(msg.swh);cafesdk.ad_init(msg.adids,params.isAd);cafesdk.share_init(msg.shareTemp,params.isShare);cafesdk.togame_init(msg.games,msg.togame);self._sdk=new cafesdk.PlatSDK();self._sdk.init();self._game=new cafesdk.PlatGame();self._commonNet=new cafesdk.NetCommonSDK();self._commonNet.getIpAddress();callback&&callback.run()}))}))};PlatApi.prototype.plat_action=function(act,params,callback){var self=this;switch(act){case cafesdk.SDKActionType.SET_NET_WORK_HANDLER:self._sdk.netWorkHandler=callback;break;case cafesdk.SDKActionType.SHOW_VIDEO:callback&&callback.runWith([1]);break;default:callback&&callback.runWith([1]);break}return null};PlatApi.prototype.game_action=function(act,params,callback){var self=this;switch(act){case cafesdk.GameActionType.LOGIN:self._game.login(callback);break;case cafesdk.GameActionType.GET_CONFIG:break;default:callback&&callback.runWith([1]);break}return null};PlatApi.prototype.get_info=function(type){var self=this;switch(type){case cafesdk.GetInfoType.openId:return self._game.openid;case cafesdk.GetInfoType.isConnected:return self.isConnected}return null};return PlatApi}(cafesdk.BaseApi));cafesdk.PlatApi=PlatApi})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var PlatGame=(function(){function PlatGame(){}PlatGame.prototype.login=function(callback){var netWork=new cafesdk.net.NetWork();var uuid=cafesdk.utils.getUUID()};return PlatGame}());cafesdk.PlatGame=PlatGame})(cafesdk||(cafesdk={}));var cafesdk;(function(cafesdk){var PlatSDK=(function(){function PlatSDK(){}PlatSDK.prototype.init=function(){var self=this;self.onNetStateChange();window["onerror"]=function(msg,url,row,col,error){var info={};info.game_id=cafesdk.config.GAMEID.toString();info.sysinfo="PC_WIN10_WEB_PC_"+cafesdk.RESOURCE_VERSION.toString();info.err=error.stack;info.time=Math.round(new Date().getTime()/1000);cafesdk.net.NetWork.sendLog("gamelog",info).start()}};PlatSDK.prototype.onNetStateChange=function(){var self=this;window.addEventListener("offline",function(e){var res={isConnected:false};cafesdk.PlatApi.inst.isConnected=false;self.netWorkHandler&&self.netWorkHandler.runWith([res])});window.addEventListener("online",function(e){var res={isConnected:true};cafesdk.PlatApi.inst.isConnected=true;self.netWorkHandler&&self.netWorkHandler.runWith([res])})};return PlatSDK}());cafesdk.PlatSDK=PlatSDK})(cafesdk||(cafesdk={}));window["cafesdk"]=cafesdk;